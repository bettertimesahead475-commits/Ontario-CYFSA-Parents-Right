<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>New Analysis</title>

<style>
:root {
    --primary: #4F46E5;
    --primary-text: #111827;
    --secondary-text: #6B7280;
    --background: #F9FAFB;
    --secondary-bg: #FFFFFF;
    --border: #E5E7EB;
    --error: #DC2626;
    --button-text: #FFFFFF;
}

body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--background);
    color: var(--primary-text);
    display: flex;
    flex-direction: column;
    height: 100vh;
}

.container {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}

h1 {
    text-align: center;
    font-size: 20px;
    margin-bottom: 20px;
}

.section-title {
    font-size: 22px;
    font-weight: bold;
    margin-bottom: 8px;
}

.section-subtitle {
    color: var(--secondary-text);
    margin-bottom: 20px;
}

.textarea-wrapper {
    position: relative;
    background: var(--secondary-bg);
    border-radius: 16px;
    border: 1px solid var(--border);
    padding: 16px;
    min-height: 250px;
    display: flex;
    flex-direction: column;
}

textarea {
    border: none;
    resize: none;
    width: 100%;
    height: 200px;
    font-size: 16px;
    outline: none;
    background: transparent;
    color: var(--primary-text);
}

.placeholder {
    position: absolute;
    pointer-events: none;
    color: rgba(107,114,128,0.6);
    font-size: 15px;
}

.meta-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 13px;
    margin-top: 8px;
    color: var(--secondary-text);
}

.clear-btn {
    cursor: pointer;
    color: var(--primary);
    border: none;
    background: none;
    font-size: 13px;
}

.error-box {
    margin-top: 16px;
    padding: 12px;
    border-radius: 12px;
    background: rgba(220,38,38,0.1);
    color: var(--error);
    display: none;
}

.footer {
    border-top: 1px solid var(--border);
    padding: 16px 20px;
    background: var(--background);
}

button.primary {
    width: 100%;
    padding: 18px;
    border-radius: 16px;
    border: none;
    font-size: 16px;
    font-weight: bold;
    background: var(--primary);
    color: var(--button-text);
    cursor: pointer;
}

button.primary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.loading {
    display: none;
}
</style>
</head>

<body>

<div class="container">
    <h1>New Analysis</h1>

    <div class="section-title">Share Your Story</div>
    <div class="section-subtitle">
        Describe a moment with your child. The more details you share, the better insights you'll receive.
    </div>

    <div class="textarea-wrapper">
        <div id="placeholder" class="placeholder">
            <strong>Example:</strong><br><br>
            My son cries when I drop him off, asking to come home with me.
            But the next time I pick him up, he cries to stay.
            I feel confused about what he really wants and how to handle these transitions...
        </div>

        <textarea id="interactionText"></textarea>

        <div class="meta-row">
            <div>
                <span id="charCount">0</span> characters
            </div>
            <button class="clear-btn" id="clearBtn" style="display:none;">
                Clear
            </button>
        </div>
    </div>

    <div id="errorBox" class="error-box"></div>
</div>

<div class="footer">
    <button id="analyzeBtn" class="primary" disabled>
        Get AI Insights →
    </button>
</div>

<script>
const textarea = document.getElementById("interactionText");
const charCount = document.getElementById("charCount");
const clearBtn = document.getElementById("clearBtn");
const analyzeBtn = document.getElementById("analyzeBtn");
const placeholder = document.getElementById("placeholder");
const errorBox = document.getElementById("errorBox");

textarea.addEventListener("input", () => {
    const text = textarea.value;
    charCount.textContent = text.length;

    placeholder.style.display = text.length === 0 ? "block" : "none";
    clearBtn.style.display = text.length > 0 ? "inline" : "none";
    analyzeBtn.disabled = text.trim().length === 0;

    errorBox.style.display = "none";
});

clearBtn.addEventListener("click", () => {
    textarea.value = "";
    textarea.dispatchEvent(new Event("input"));
});

analyzeBtn.addEventListener("click", async () => {
    const text = textarea.value.trim();
    if (!text) {
        showError("Please describe the interaction first.");
        return;
    }

    analyzeBtn.disabled = true;
    analyzeBtn.textContent = "Analyzing Your Story...";
    
    try {
        // Replace this with your real API call
        await fakeAnalysis(text);

        alert("Analysis complete! Replace this with navigation to result page.");
    } catch (err) {
        showError("An unexpected error occurred. Please try again.");
    }

    analyzeBtn.disabled = false;
    analyzeBtn.textContent = "Get AI Insights →";
});

function showError(message) {
    errorBox.textContent = message;
    errorBox.style.display = "block";
}

function fakeAnalysis(text) {
    return new Promise((resolve) => {
        setTimeout(() => resolve(), 2000);
    });
}
</script>

</body>
</html>
